# 实现CRUD API容器调度中间层

## 1. 需求分析
根据用户需求，需要实现对后端通用CRUD API容器的调度，支持：
- 单容器调度（当前已实现）
- 读写分离两容器调度
- 负载均衡分布式容器调度

## 2. 实现方案

### 2.1 修改配置结构
- 修改`CrudApiConfig`，支持多个CRUD API实例
- 添加调度策略配置
- 支持读写分离配置

### 2.2 实现调度器模块
创建新的`src/scheduler/`模块，包含：
- 调度策略枚举：Single、ReadWriteSplit、LoadBalance
- 调度器结构体：管理多个CRUD API实例
- 健康检查机制：定期检查CRUD API实例状态
- 故障转移机制：自动切换到健康实例

### 2.3 更新服务层
- 修改`EncryptionService`，使用调度器调用CRUD API
- 实现基于请求类型的调度逻辑
- 支持不同调度策略的切换

## 3. 实现步骤

1. **修改配置结构**
   - 更新`src/config/mod.rs`，添加多实例支持
   - 添加调度策略配置

2. **实现调度器模块**
   - 创建`src/scheduler/mod.rs`
   - 实现调度器核心逻辑
   - 实现健康检查机制
   - 实现不同调度策略

3. **更新服务层**
   - 修改`src/service/mod.rs`，集成调度器
   - 更新所有CRUD API调用逻辑
   - 实现基于请求类型的路由

4. **测试和验证**
   - 确保原有功能正常
   - 测试不同调度策略
   - 测试故障转移机制

## 4. 架构设计

```
API层 → Service层 → 调度器 → CRUD API集群
```

调度器将根据配置的策略，智能选择合适的CRUD API实例处理请求，实现高可用和负载均衡。